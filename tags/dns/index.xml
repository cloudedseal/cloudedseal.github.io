<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>keep doing – Dns</title><link>https://cloudedseal.github.io/tags/dns/</link><description>Recent content in Dns on keep doing</description><generator>Hugo -- gohugo.io</generator><language>en</language><lastBuildDate>Wed, 30 Jul 2025 17:07:23 +0800</lastBuildDate><atom:link href="https://cloudedseal.github.io/tags/dns/index.xml" rel="self" type="application/rss+xml"/><item><title>Master Dynamic Dns</title><link>https://cloudedseal.github.io/blog/master-dynamic-dns/</link><pubDate>Wed, 30 Jul 2025 17:07:23 +0800</pubDate><guid>https://cloudedseal.github.io/blog/master-dynamic-dns/</guid><description>
&lt;h2>重要概念&lt;span class="hx-absolute -hx-mt-20" id="重要概念">&lt;/span>
&lt;a href="#%e9%87%8d%e8%a6%81%e6%a6%82%e5%bf%b5" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;h3>dns zone&lt;span class="hx-absolute -hx-mt-20" id="dns-zone">&lt;/span>
&lt;a href="#dns-zone" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;blockquote>
&lt;p>A DNS zone is a portion of the DNS namespace that is managed by a specific organization or administrator.
All of the information for a zone is stored in what’s called a &lt;code>DNS zone file&lt;/code>, which is the key to understanding how a DNS zone operates.
一个 zone 就是由一个机构或者管理员管理的某一个 DNS namespace。所有的信息存在 DNS zone file 中。我的地盘我做主。&lt;/p>
&lt;/blockquote>
&lt;h3>dns zone file&lt;span class="hx-absolute -hx-mt-20" id="dns-zone-file">&lt;/span>
&lt;a href="#dns-zone-file" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;blockquote>
&lt;p>A zone file is a plain text file stored in a DNS server that contains an actual representation of the zone and contains all the records for every domain within the zone. Zone files must always start with a &lt;a href="https://www.cloudflare.com/learning/dns/dns-records/dns-soa-record/" target="_blank" rel="noopener">Start of Authority (SOA) record&lt;/a>, which contains important information including contact information for the zone administrator.&lt;/p>
&lt;/blockquote>
&lt;ol>
&lt;li>文本文件&lt;/li>
&lt;li>包括该 zone 下每一个 domain 的所有 record&lt;/li>
&lt;li>必须以 SOA record 开始&lt;/li>
&lt;/ol>
&lt;h2>DNS服务-bind&lt;span class="hx-absolute -hx-mt-20" id="dns服务-bind">&lt;/span>
&lt;a href="#dns%e6%9c%8d%e5%8a%a1-bind" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>&lt;code>rpm -ql bind&lt;/code>&lt;/p>
&lt;blockquote>
&lt;p>/etc/logrotate.d/named&lt;br>
/etc/named&lt;br>
/etc/named.conf&lt;br>
/etc/named.iscdlv.key&lt;br>
/etc/named.rfc1912.zones&lt;br>
/etc/named.root.key&lt;br>
/etc/rndc.conf&lt;br>
/etc/rndc.key&lt;br>
/etc/rwtab.d/named&lt;br>
/etc/sysconfig/named&lt;br>
/run/named&lt;br>
/usr/bin/arpaname&lt;br>
/usr/bin/named-rrchecker&lt;br>
/usr/lib/systemd/system/named-setup-rndc.service&lt;br>
/usr/lib/systemd/system/named.service&lt;br>
/usr/lib/tmpfiles.d/named.conf&lt;br>
/usr/lib64/bind&lt;br>
/usr/libexec/generate-rndc-key.sh&lt;br>
/usr/sbin/ddns-confgen&lt;br>
/usr/sbin/dnssec-checkds&lt;br>
/usr/sbin/dnssec-coverage&lt;br>
/usr/sbin/dnssec-dsfromkey&lt;br>
/usr/sbin/dnssec-importkey&lt;br>
/usr/sbin/dnssec-keyfromlabel&lt;br>
/usr/sbin/dnssec-keygen&lt;br>
/usr/sbin/dnssec-keymgr&lt;br>
/usr/sbin/dnssec-revoke&lt;br>
/usr/sbin/dnssec-settime&lt;br>
/usr/sbin/dnssec-signzone&lt;br>
/usr/sbin/dnssec-verify&lt;br>
/usr/sbin/genrandom&lt;br>
/usr/sbin/isc-hmac-fixup&lt;br>
/usr/sbin/lwresd&lt;br>
/usr/sbin/named&lt;br>
/usr/sbin/named-checkconf&lt;br>
/usr/sbin/named-checkzone&lt;br>
/usr/sbin/named-compilezone&lt;br>
/usr/sbin/named-journalprint&lt;br>
/usr/sbin/nsec3hash&lt;br>
/usr/sbin/rndc&lt;br>
/usr/sbin/rndc-confgen&lt;br>
/usr/sbin/tsig-keygen
/usr/share/doc/bind-9.11.4/man.arpaname.html&lt;br>
/usr/share/doc/bind-9.11.4/man.ddns-confgen.html&lt;br>
/usr/share/doc/bind-9.11.4/man.delv.html&lt;br>
/usr/share/doc/bind-9.11.4/man.dig.html&lt;br>
/usr/share/doc/bind-9.11.4/man.dnssec-checkds.html&lt;br>
/usr/share/doc/bind-9.11.4/man.dnssec-coverage.html&lt;br>
/usr/share/doc/bind-9.11.4/man.dnssec-dsfromkey.html&lt;br>
/usr/share/doc/bind-9.11.4/man.dnssec-importkey.html&lt;br>
/usr/share/doc/bind-9.11.4/man.dnssec-keyfromlabel.html&lt;br>
/usr/share/doc/bind-9.11.4/man.dnssec-keygen.html&lt;br>
/usr/share/doc/bind-9.11.4/man.dnssec-keymgr.html&lt;br>
/usr/share/doc/bind-9.11.4/man.dnssec-revoke.html&lt;br>
/usr/share/doc/bind-9.11.4/man.dnssec-settime.html&lt;br>
/usr/share/doc/bind-9.11.4/man.dnssec-signzone.html&lt;br>
/usr/share/doc/bind-9.11.4/man.dnssec-verify.html&lt;br>
/usr/share/doc/bind-9.11.4/man.dnstap-read.html&lt;br>
/usr/share/doc/bind-9.11.4/man.genrandom.html&lt;br>
/usr/share/doc/bind-9.11.4/man.host.html&lt;br>
/usr/share/doc/bind-9.11.4/man.isc-hmac-fixup.html&lt;br>
/usr/share/doc/bind-9.11.4/man.lwresd.html&lt;br>
/usr/share/doc/bind-9.11.4/man.mdig.html&lt;br>
/usr/share/doc/bind-9.11.4/man.named-checkconf.html&lt;br>
/usr/share/doc/bind-9.11.4/man.named-checkzone.html&lt;br>
/usr/share/doc/bind-9.11.4/man.named-journalprint.html&lt;br>
/usr/share/doc/bind-9.11.4/man.named-nzd2nzf.html&lt;br>
/usr/share/doc/bind-9.11.4/man.named-rrchecker.html&lt;br>
/usr/share/doc/bind-9.11.4/man.named.conf.html&lt;br>
/usr/share/doc/bind-9.11.4/man.named.html&lt;br>
/usr/share/doc/bind-9.11.4/man.nsec3hash.html&lt;br>
/usr/share/doc/bind-9.11.4/man.nslookup.html&lt;br>
/usr/share/doc/bind-9.11.4/man.nsupdate.html&lt;br>
/usr/share/doc/bind-9.11.4/man.pkcs11-destroy.html&lt;br>
/usr/share/doc/bind-9.11.4/man.pkcs11-keygen.html&lt;br>
/usr/share/doc/bind-9.11.4/man.pkcs11-list.html&lt;br>
/usr/share/doc/bind-9.11.4/man.pkcs11-tokens.html&lt;br>
/usr/share/doc/bind-9.11.4/man.rndc-confgen.html&lt;br>
/usr/share/doc/bind-9.11.4/man.rndc.conf.html&lt;br>
/usr/share/doc/bind-9.11.4/man.rndc.html&lt;br>
/usr/share/doc/bind-9.11.4/named.conf.default&lt;br>
/usr/share/doc/bind-9.11.4/notes.html&lt;br>
/usr/share/doc/bind-9.11.4/notes.pdf&lt;br>
/usr/share/doc/bind-9.11.4/sample&lt;br>
/usr/share/doc/bind-9.11.4/sample/etc&lt;br>
/usr/share/doc/bind-9.11.4/sample/etc/named.conf&lt;br>
/usr/share/doc/bind-9.11.4/sample/etc/named.rfc1912.zones&lt;br>
/usr/share/doc/bind-9.11.4/sample/var&lt;br>
/usr/share/doc/bind-9.11.4/sample/var/named&lt;br>
/usr/share/doc/bind-9.11.4/sample/var/named/data&lt;br>
/usr/share/doc/bind-9.11.4/sample/var/named/my.external.zone.db&lt;br>
/usr/share/doc/bind-9.11.4/sample/var/named/my.internal.zone.db&lt;br>
/usr/share/doc/bind-9.11.4/sample/var/named/named.ca&lt;br>
/usr/share/doc/bind-9.11.4/sample/var/named/named.empty&lt;br>
/usr/share/doc/bind-9.11.4/sample/var/named/named.localhost&lt;br>
/usr/share/doc/bind-9.11.4/sample/var/named/named.loopback&lt;br>
/usr/share/doc/bind-9.11.4/sample/var/named/slaves&lt;br>
/usr/share/doc/bind-9.11.4/sample/var/named/slaves/my.ddns.internal.zone.db&lt;br>
/usr/share/doc/bind-9.11.4/sample/var/named/slaves/my.slave.internal.zone.db&lt;br>
/usr/share/man/man1/arpaname.1.gz&lt;br>
/usr/share/man/man1/named-rrchecker.1.gz&lt;br>
/usr/share/man/man5/named.conf.5.gz&lt;br>
/usr/share/man/man5/rndc.conf.5.gz&lt;br>
/usr/share/man/man8/ddns-confgen.8.gz&lt;br>
/usr/share/man/man8/dnssec-checkds.8.gz&lt;br>
/usr/share/man/man8/dnssec-coverage.8.gz&lt;br>
/usr/share/man/man8/dnssec-dsfromkey.8.gz&lt;br>
/usr/share/man/man8/dnssec-importkey.8.gz&lt;br>
/usr/share/man/man8/dnssec-keyfromlabel.8.gz&lt;br>
/usr/share/man/man8/dnssec-keygen.8.gz&lt;br>
/usr/share/man/man8/dnssec-keymgr.8.gz&lt;br>
/usr/share/man/man8/dnssec-revoke.8.gz&lt;br>
/usr/share/man/man8/dnssec-settime.8.gz&lt;br>
/usr/share/man/man8/dnssec-signzone.8.gz&lt;br>
/usr/share/man/man8/dnssec-verify.8.gz&lt;br>
/usr/share/man/man8/genrandom.8.gz&lt;br>
/usr/share/man/man8/isc-hmac-fixup.8.gz&lt;br>
/usr/share/man/man8/lwresd.8.gz&lt;br>
/usr/share/man/man8/named-checkconf.8.gz&lt;br>
/usr/share/man/man8/named-checkzone.8.gz&lt;br>
/usr/share/man/man8/named-compilezone.8.gz&lt;br>
/usr/share/man/man8/named-journalprint.8.gz&lt;br>
/usr/share/man/man8/named.8.gz&lt;br>
/usr/share/man/man8/nsec3hash.8.gz&lt;br>
/usr/share/man/man8/rndc-confgen.8.gz&lt;br>
/usr/share/man/man8/rndc.8.gz&lt;br>
/usr/share/man/man8/tsig-keygen.8.gz&lt;br>
/var/named&lt;br>
/var/named/data&lt;br>
/var/named/dynamic&lt;br>
/var/named/named.ca 13 个 rootnameserver 的信息
/var/named/named.empty&lt;br>
/var/named/named.localhost&lt;br>
/var/named/named.loopback&lt;br>
/var/named/slaves&lt;/p>
&lt;/blockquote>
&lt;ol>
&lt;li>/var/named/named.ca 13 个 rootnameserver 的信息&lt;/li>
&lt;/ol>
&lt;h3>/var/named/named.ca&lt;span class="hx-absolute -hx-mt-20" id="varnamednamedca">&lt;/span>
&lt;a href="#varnamednamedca" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">&lt;span class="p">;&lt;/span> &amp;lt;&amp;lt;&amp;gt;&amp;gt; DiG 9.11.3-RedHat-9.11.3-3.fc27 &amp;lt;&amp;lt;&amp;gt;&amp;gt; +bufsize&lt;span class="o">=&lt;/span>&lt;span class="m">1200&lt;/span> +norec @a.root-servers.net
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">;&lt;/span> &lt;span class="o">(&lt;/span>&lt;span class="m">2&lt;/span> servers found&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">;;&lt;/span> global options: +cmd
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">;;&lt;/span> Got answer:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">;;&lt;/span> -&amp;gt;&amp;gt;HEADER&lt;span class="s">&amp;lt;&amp;lt;- opco&lt;/span>de: QUERY, status: NOERROR, id: &lt;span class="m">46900&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">;;&lt;/span> flags: qr aa&lt;span class="p">;&lt;/span> QUERY: 1, ANSWER: 13, AUTHORITY: 0, ADDITIONAL: &lt;span class="m">27&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">;;&lt;/span> OPT PSEUDOSECTION:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">;&lt;/span> EDNS: version: 0, flags:&lt;span class="p">;&lt;/span> udp: &lt;span class="m">1472&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">;;&lt;/span> QUESTION SECTION:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">;&lt;/span>. IN NS
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">;;&lt;/span> ANSWER SECTION:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">. &lt;span class="m">518400&lt;/span> IN NS a.root-servers.net.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">. &lt;span class="m">518400&lt;/span> IN NS b.root-servers.net.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">. &lt;span class="m">518400&lt;/span> IN NS c.root-servers.net.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">. &lt;span class="m">518400&lt;/span> IN NS d.root-servers.net.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">. &lt;span class="m">518400&lt;/span> IN NS e.root-servers.net.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">. &lt;span class="m">518400&lt;/span> IN NS f.root-servers.net.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">. &lt;span class="m">518400&lt;/span> IN NS g.root-servers.net.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">. &lt;span class="m">518400&lt;/span> IN NS h.root-servers.net.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">. &lt;span class="m">518400&lt;/span> IN NS i.root-servers.net.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">. &lt;span class="m">518400&lt;/span> IN NS j.root-servers.net.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">. &lt;span class="m">518400&lt;/span> IN NS k.root-servers.net.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">. &lt;span class="m">518400&lt;/span> IN NS l.root-servers.net.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">. &lt;span class="m">518400&lt;/span> IN NS m.root-servers.net.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">;;&lt;/span> ADDITIONAL SECTION:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">a.root-servers.net. &lt;span class="m">518400&lt;/span> IN A 198.41.0.4
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">b.root-servers.net. &lt;span class="m">518400&lt;/span> IN A 199.9.14.201
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">c.root-servers.net. &lt;span class="m">518400&lt;/span> IN A 192.33.4.12
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">d.root-servers.net. &lt;span class="m">518400&lt;/span> IN A 199.7.91.13
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">e.root-servers.net. &lt;span class="m">518400&lt;/span> IN A 192.203.230.10
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">f.root-servers.net. &lt;span class="m">518400&lt;/span> IN A 192.5.5.241
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">g.root-servers.net. &lt;span class="m">518400&lt;/span> IN A 192.112.36.4
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">h.root-servers.net. &lt;span class="m">518400&lt;/span> IN A 198.97.190.53
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">i.root-servers.net. &lt;span class="m">518400&lt;/span> IN A 192.36.148.17
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">j.root-servers.net. &lt;span class="m">518400&lt;/span> IN A 192.58.128.30
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">k.root-servers.net. &lt;span class="m">518400&lt;/span> IN A 193.0.14.129
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">l.root-servers.net. &lt;span class="m">518400&lt;/span> IN A 199.7.83.42
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">m.root-servers.net. &lt;span class="m">518400&lt;/span> IN A 202.12.27.33
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">a.root-servers.net. &lt;span class="m">518400&lt;/span> IN AAAA 2001:503:ba3e::2:30
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">b.root-servers.net. &lt;span class="m">518400&lt;/span> IN AAAA 2001:500:200::b
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">c.root-servers.net. &lt;span class="m">518400&lt;/span> IN AAAA 2001:500:2::c
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">d.root-servers.net. &lt;span class="m">518400&lt;/span> IN AAAA 2001:500:2d::d
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">e.root-servers.net. &lt;span class="m">518400&lt;/span> IN AAAA 2001:500:a8::e
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">f.root-servers.net. &lt;span class="m">518400&lt;/span> IN AAAA 2001:500:2f::f
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">g.root-servers.net. &lt;span class="m">518400&lt;/span> IN AAAA 2001:500:12::d0d
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">h.root-servers.net. &lt;span class="m">518400&lt;/span> IN AAAA 2001:500:1::53
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">i.root-servers.net. &lt;span class="m">518400&lt;/span> IN AAAA 2001:7fe::53
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">j.root-servers.net. &lt;span class="m">518400&lt;/span> IN AAAA 2001:503:c27::2:30
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">k.root-servers.net. &lt;span class="m">518400&lt;/span> IN AAAA 2001:7fd::1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">l.root-servers.net. &lt;span class="m">518400&lt;/span> IN AAAA 2001:500:9f::42
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">m.root-servers.net. &lt;span class="m">518400&lt;/span> IN AAAA 2001:dc3::35
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">;;&lt;/span> Query time: &lt;span class="m">24&lt;/span> msec
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">;;&lt;/span> SERVER: 198.41.0.4#53&lt;span class="o">(&lt;/span>198.41.0.4&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">;;&lt;/span> WHEN: Thu Apr &lt;span class="m">05&lt;/span> 15:57:34 CEST &lt;span class="m">2018&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">;;&lt;/span> MSG SIZE rcvd: &lt;span class="m">811&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;h3>name.conf&lt;span class="hx-absolute -hx-mt-20" id="nameconf">&lt;/span>
&lt;a href="#nameconf" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>centos 安装后查看 &lt;code>/usr/share/doc/bind*/sample/&lt;/code> 样例配置&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># named.conf&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># Provided by Red Hat bind package to configure the ISC BIND named(8) DNS&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># server as a caching only nameserver (as a localhost DNS resolver only).&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># See /usr/share/doc/bind*/sample/ for example named configuration files.&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># See the BIND Administrator&amp;#39;s Reference Manual (ARM) for details about the&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># configuration located in /usr/share/doc/bind-{version}/Bv9ARM.html&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">options &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> listen-on port &lt;span class="m">53&lt;/span> &lt;span class="o">{&lt;/span> 127.0.0.1&lt;span class="p">;&lt;/span> &lt;span class="o">}&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> listen-on-v6 port &lt;span class="m">53&lt;/span> &lt;span class="o">{&lt;/span> ::1&lt;span class="p">;&lt;/span> &lt;span class="o">}&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> directory &lt;span class="s2">&amp;#34;/var/named&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> dump-file &lt;span class="s2">&amp;#34;/var/named/data/cache_dump.db&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> statistics-file &lt;span class="s2">&amp;#34;/var/named/data/named_stats.txt&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> memstatistics-file &lt;span class="s2">&amp;#34;/var/named/data/named_mem_stats.txt&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> recursing-file &lt;span class="s2">&amp;#34;/var/named/data/named.recursing&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> secroots-file &lt;span class="s2">&amp;#34;/var/named/data/named.secroots&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> allow-query &lt;span class="o">{&lt;/span> localhost&lt;span class="p">;&lt;/span> &lt;span class="o">}&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> /*
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - If you are building an AUTHORITATIVE DNS server, &lt;span class="k">do&lt;/span> NOT &lt;span class="nb">enable&lt;/span> recursion.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - If you are building a RECURSIVE &lt;span class="o">(&lt;/span>caching&lt;span class="o">)&lt;/span> DNS server, you need to &lt;span class="nb">enable&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> recursion.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - If your recursive DNS server has a public IP address, you MUST &lt;span class="nb">enable&lt;/span> access
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> control to limit queries to your legitimate users. Failing to &lt;span class="k">do&lt;/span> so will
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> cause your server to become part of large scale DNS amplification
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> attacks. Implementing BCP38 within your network would greatly
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> reduce such attack surface
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> */
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> recursion yes&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> dnssec-enable yes&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> dnssec-validation yes&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> /* Path to ISC DLV key */
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> bindkeys-file &lt;span class="s2">&amp;#34;/etc/named.root.key&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> managed-keys-directory &lt;span class="s2">&amp;#34;/var/named/dynamic&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> pid-file &lt;span class="s2">&amp;#34;/run/named/named.pid&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> session-keyfile &lt;span class="s2">&amp;#34;/run/named/session.key&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">}&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">logging &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> channel default_debug &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> file &lt;span class="s2">&amp;#34;data/named.run&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> severity dynamic&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">}&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">}&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">zone &lt;span class="s2">&amp;#34;.&amp;#34;&lt;/span> IN &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">type&lt;/span> hint&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> file &lt;span class="s2">&amp;#34;named.ca&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">}&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">include &lt;span class="s2">&amp;#34;/etc/named.rfc1912.zones&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">include &lt;span class="s2">&amp;#34;/etc/named.root.key&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;h2>dns record&lt;span class="hx-absolute -hx-mt-20" id="dns-record">&lt;/span>
&lt;a href="#dns-record" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>&lt;a href="https://www.cloudflare.com/learning/dns/dns-records/" target="_blank" rel="noopener">https://www.cloudflare.com/learning/dns/dns-records/&lt;/a>&lt;/p>
&lt;p>authoritative dns server -&amp;gt; DNS records(zone files) -&amp;gt; TTL&lt;/p>
&lt;h3>&lt;code>A&lt;/code> record&lt;span class="hx-absolute -hx-mt-20" id="a-record">&lt;/span>
&lt;a href="#a-record" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>address record&lt;/p>
&lt;p>&lt;a href="https://www.cloudflare.com/learning/dns/dns-records/dns-a-record/" target="_blank" rel="noopener">https://www.cloudflare.com/learning/dns/dns-records/dns-a-record/&lt;/a>&lt;/p>
&lt;h3>&lt;code>CNAME&lt;/code> record&lt;span class="hx-absolute -hx-mt-20" id="cname-record">&lt;/span>
&lt;a href="#cname-record" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>canonical name&lt;/p>
&lt;p>&lt;a href="https://www.cloudflare.com/learning/dns/dns-records/dns-cname-record/" target="_blank" rel="noopener">https://www.cloudflare.com/learning/dns/dns-records/dns-cname-record/&lt;/a>&lt;/p>
&lt;p>指向另一个域名&lt;/p>
&lt;p>如 blog.example.com 有一个 CNAME record 是 example.com。&lt;/p>
&lt;p>当一个 dns server 命中 blog.example.com 的 dns record 时，实际上会触发另外一个 example.com 的 dns lookup。返回 example.com 的 A record(ip 地址)。&lt;/p>
&lt;p>blog.example.com CNAME example.com
shop.example.com CNAME example.com&lt;/p>
&lt;p>如果 ip 变化了，只需要修改 example.com 的 A record&lt;/p>
&lt;h3>&lt;code>NS&lt;/code> record&lt;span class="hx-absolute -hx-mt-20" id="ns-record">&lt;/span>
&lt;a href="#ns-record" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>nameserver&lt;/p>
&lt;p>&lt;a href="https://www.cloudflare.com/learning/dns/dns-records/dns-ns-record/" target="_blank" rel="noopener">https://www.cloudflare.com/learning/dns/dns-records/dns-ns-record/&lt;/a>&lt;/p>
&lt;p>存储了一个 domain 所有的 DNS records，包括 A record, MX record, CNAME record. 多个 NS 增加可用性。&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">dog -t NS taobao.com
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">NS taobao.com. 1s &lt;span class="s2">&amp;#34;ns5.taobao.com.&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">NS taobao.com. 1s &lt;span class="s2">&amp;#34;ns4.taobao.com.&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">NS taobao.com. 1s &lt;span class="s2">&amp;#34;ns6.taobao.com.&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">NS taobao.com. 1s &lt;span class="s2">&amp;#34;ns7.taobao.com.&amp;#34;&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">dog -t NS ns5.taobao.com.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">SOA taobao.com. 20m00s A &lt;span class="s2">&amp;#34;ns4.taobao.com.&amp;#34;&lt;/span> &lt;span class="s2">&amp;#34;hostmaster.alibabadns.com.&amp;#34;&lt;/span> &lt;span class="m">2018011109&lt;/span> 1h00m00s 20m00s 1h00m00s 6m00s&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;h3>SOA record&lt;span class="hx-absolute -hx-mt-20" id="soa-record">&lt;/span>
&lt;a href="#soa-record" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>&lt;a href="https://www.cloudflare.com/learning/dns/dns-records/dns-soa-record/" target="_blank" rel="noopener">https://www.cloudflare.com/learning/dns/dns-records/dns-soa-record/&lt;/a>&lt;/p>
&lt;blockquote>
&lt;p>store &lt;code>admin info&lt;/code> about a domain.&lt;/p>
&lt;/blockquote>
&lt;p>start of authority&lt;/p>
&lt;p>DNS SOA record 存储一个 domain 或者 zone 的重要信息。包括：&lt;/p>
&lt;p>email address of the administrator&lt;/p>
&lt;p>when the domain was last updated&lt;/p>
&lt;p>how long the server should wait between refreshes.&lt;/p>
&lt;p>&lt;a href="https://www.okta.com/identity-101/soa-record/#:~:text=A%20DNS%20SOA%20record%20contains,party%20responsible%20for%20the%20domain." target="_blank" rel="noopener">https://www.okta.com/identity-101/soa-record/#:~:text=A%20DNS%20SOA%20record%20contains,party%20responsible%20for%20the%20domain.&lt;/a>&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl"> dig soa baidu.com
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">;&lt;/span> &amp;lt;&amp;lt;&amp;gt;&amp;gt; DiG 9.11.4-P2-RedHat-9.11.4-26.P2.el7_9.15 &amp;lt;&amp;lt;&amp;gt;&amp;gt; soa baidu.com
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">;;&lt;/span> global options: +cmd
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">;;&lt;/span> Got answer:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">;;&lt;/span> -&amp;gt;&amp;gt;HEADER&lt;span class="s">&amp;lt;&amp;lt;- opco&lt;/span>de: QUERY, status: NOERROR, id: &lt;span class="m">44818&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">;;&lt;/span> flags: qr rd ra&lt;span class="p">;&lt;/span> QUERY: 1, ANSWER: 1, AUTHORITY: 0, ADDITIONAL: &lt;span class="m">1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">;;&lt;/span> OPT PSEUDOSECTION:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">;&lt;/span> EDNS: version: 0, flags:&lt;span class="p">;&lt;/span> udp: &lt;span class="m">512&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">;;&lt;/span> QUESTION SECTION:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">;&lt;/span>baidu.com. IN SOA
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">;;&lt;/span> ANSWER SECTION:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">baidu.com. &lt;span class="m">2849&lt;/span> IN SOA dns.baidu.com. sa.baidu.com. &lt;span class="m">2012147685&lt;/span> &lt;span class="m">300&lt;/span> &lt;span class="m">300&lt;/span> &lt;span class="m">2592000&lt;/span> &lt;span class="m">7200&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">;;&lt;/span> Query time: &lt;span class="m">30&lt;/span> msec
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">;;&lt;/span> SERVER: 114.114.114.114#53&lt;span class="o">(&lt;/span>114.114.114.114&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">;;&lt;/span> WHEN: 一 12月 &lt;span class="m">25&lt;/span> 14:24:35 CST &lt;span class="m">2023&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">;;&lt;/span> MSG SIZE rcvd: &lt;span class="m">81&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;blockquote>
&lt;p>;; ANSWER SECTION:&lt;/p>
&lt;/blockquote>
&lt;p>baidu.com. 2849 IN SOA dns.baidu.com. sa.baidu.com. 2012147685 300 300 2592000 7200&lt;/p>
&lt;p>MNAME &lt;u>dns.baidu.com. &lt;/u> &lt;em>&lt;strong>primary server for this zone &lt;strong>__&lt;/strong>&lt;font style="color:#DF2A3F;">zone&amp;rsquo;s master server&lt;/font>&lt;/strong>&lt;/em>&lt;/p>
&lt;p>RNAME &lt;u>sa.baidu.com. &lt;/u> &lt;em>&lt;strong>administrator&amp;rsquo;s email address，但是没有 &lt;font style="color:#DF2A3F;">@&lt;/font>&lt;/strong>&lt;/em>&lt;/p>
&lt;p>SERIAL &lt;u>2012147685&lt;/u> &lt;em>&lt;strong>a number representation of changes，每次修改序列号加 1&lt;/strong>&lt;/em>&lt;/p>
&lt;p>REFRESH &lt;u>300&lt;/u> The time in seconds secondary servers should wait before asking the primary server for a new SOA record indicating changes.&lt;/p>
&lt;p>RETRY &lt;u>300&lt;/u> How long a server should wait after a failed refresh before asking again.&lt;/p>
&lt;p>EXPIRE &lt;u>2592000&lt;/u> The upper time limit before a zone isn&amp;rsquo;t considered authoritative.&lt;/p>
&lt;p>MINIMUM &lt;u>7200&lt;/u> A measurement of &amp;ldquo;time to live&amp;rdquo; or how long a resolver should wait.&lt;/p>
&lt;h3>&lt;code>PTR&lt;/code> record&lt;span class="hx-absolute -hx-mt-20" id="ptr-record">&lt;/span>
&lt;a href="#ptr-record" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>&lt;a href="https://www.cloudflare.com/learning/dns/dns-records/dns-ptr-record/" target="_blank" rel="noopener">https://www.cloudflare.com/learning/dns/dns-records/dns-ptr-record/&lt;/a>&lt;/p>
&lt;blockquote>
&lt;p>pointer(PTR) 通过 ip 找域名&lt;/p>
&lt;/blockquote>
&lt;h2>dns server type&lt;span class="hx-absolute -hx-mt-20" id="dns-server-type">&lt;/span>
&lt;a href="#dns-server-type" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>&lt;a href="https://www.cloudflare.com/learning/dns/dns-server-types/" target="_blank" rel="noopener">https://www.cloudflare.com/learning/dns/dns-server-types/&lt;/a>&lt;/p>
&lt;h3>recursive resolvers&lt;span class="hx-absolute -hx-mt-20" id="recursive-resolvers">&lt;/span>
&lt;a href="#recursive-resolvers" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>DNS recursor &amp;ndash; first stop 第一站，client 向 recursive resolver 发起一个递归查询。&lt;/p>
&lt;p>收到查询请求后，要么直接返回 cached data，要么向 root nameserver 发起查询，root nameserver 返回对应的 TLD nameserver。接着向 TLD nameserver 发起查询，依次类推，最终会向 authoritative nameserver 发起请求，返回对应的 domain 的 ip 地址。同时也会将结果缓存下来。&lt;/p>
&lt;h3>root nameservers&lt;span class="hx-absolute -hx-mt-20" id="root-nameservers">&lt;/span>
&lt;a href="#root-nameservers" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>所有的 recursive resolver 都会知道 root nameservers 的 ip。&lt;/p>
&lt;p>所有 recursive resolver 查询第一站就是 root nameserver, 树形结构。&lt;/p>
&lt;h3>TLD nameservers&lt;span class="hx-absolute -hx-mt-20" id="tld-nameservers">&lt;/span>
&lt;a href="#tld-nameservers" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>记录 顶级域名如 .com 名字信息的服务器。&lt;/p>
&lt;h3>authoritative nameservers&lt;span class="hx-absolute -hx-mt-20" id="authoritative-nameservers">&lt;/span>
&lt;a href="#authoritative-nameservers" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>resolver last stop。有具体域名的 ip 信息。如 google.com。可以向 recursive resolver 提供对应的 ip（A record）地址。如果域名有 CNAME record(alias) 向 recursive resolver 提供 alias 域名，这时 recursive resolver 会发起一个全新的 DNS lookup。&lt;/p>
&lt;h3>client(stub resolver)&lt;span class="hx-absolute -hx-mt-20" id="clientstub-resolver">&lt;/span>
&lt;a href="#clientstub-resolver" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;h2>nsupdate 动态更新 DNS 命令行工具&lt;span class="hx-absolute -hx-mt-20" id="nsupdate--动态更新-dns-命令行工具">&lt;/span>
&lt;a href="#nsupdate--%e5%8a%a8%e6%80%81%e6%9b%b4%e6%96%b0-dns-%e5%91%bd%e4%bb%a4%e8%a1%8c%e5%b7%a5%e5%85%b7" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;ol>
&lt;li>&lt;a href="https://dnns.no/dynamic-dns-with-bind-and-nsupdate.html" target="_blank" rel="noopener">https://dnns.no/dynamic-dns-with-bind-and-nsupdate.html&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://bind9.readthedocs.io/en/v9.18.21/chapter6.html#dynamic-update" target="_blank" rel="noopener">https://bind9.readthedocs.io/en/v9.18.21/chapter6.html#dynamic-update&lt;/a>&lt;/li>
&lt;/ol>
&lt;h3>使用 ddns-confgen 生成 key&lt;span class="hx-absolute -hx-mt-20" id="使用-ddns-confgen-生成-key">&lt;/span>
&lt;a href="#%e4%bd%bf%e7%94%a8-ddns-confgen-%e7%94%9f%e6%88%90-key" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">ddns-confgen -k key1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># To activate this key, place the following in named.conf, and&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># in a separate keyfile on the system or systems from which nsupdate&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># will be run:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">key &lt;span class="s2">&amp;#34;key1&amp;#34;&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> algorithm hmac-sha256&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> secret &lt;span class="s2">&amp;#34;N0c+DmoYWriFeN8SAwGg+i+E+CS4jMRplzs8+fGlLAQ=&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">}&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># Then, in the &amp;#34;zone&amp;#34; statement for each zone you wish to dynamically&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># update, place an &amp;#34;update-policy&amp;#34; statement granting update permission&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># to this key. For example, the following statement grants this key&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># permission to update any name within the zone:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">update-policy &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> grant key1 zonesub ANY&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">}&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># After the keyfile has been placed, the following command will&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># execute nsupdate using this key:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">nsupdate -k &amp;lt;keyfile&amp;gt;&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;h3>配置 named.conf 的 view&lt;span class="hx-absolute -hx-mt-20" id="配置-namedconf-的-view">&lt;/span>
&lt;a href="#%e9%85%8d%e7%bd%ae-namedconf-%e7%9a%84-view" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">view &lt;span class="s2">&amp;#34;internal&amp;#34;&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> match-clients &lt;span class="o">{&lt;/span> 10.101.0.0/24&lt;span class="p">;&lt;/span> 10.101.9.11/32&lt;span class="p">;&lt;/span> key key1&lt;span class="p">;&lt;/span> &lt;span class="o">}&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> key &lt;span class="s2">&amp;#34;key1&amp;#34;&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> algorithm hmac-sha256&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> secret &lt;span class="s2">&amp;#34;N0c+DmoYWriFeN8SAwGg+i+E+CS4jMRplzs8+fGlLAQ=&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">}&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> zone &lt;span class="s2">&amp;#34;myexample.com&amp;#34;&lt;/span> IN &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">type&lt;/span> master&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> file &lt;span class="s2">&amp;#34;myexample.com.zone&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> update-policy &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> grant key1 zonesub ANY&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">}&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> notify yes&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> also-notify &lt;span class="o">{&lt;/span> 10.101.0.182&lt;span class="p">;&lt;/span> &lt;span class="o">}&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> allow-transfer &lt;span class="o">{&lt;/span> 10.101.0.182&lt;span class="p">;&lt;/span> &lt;span class="o">}&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">}&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> zone &lt;span class="s2">&amp;#34;.&amp;#34;&lt;/span> IN &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">type&lt;/span> hint&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> file &lt;span class="s2">&amp;#34;named.ca&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">}&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> include &lt;span class="s2">&amp;#34;/etc/named.rfc1912.zones&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">}&lt;/span>&lt;span class="p">;&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;h2>如何实现动态更新 Dns&lt;span class="hx-absolute -hx-mt-20" id="如何实现动态更新-dns">&lt;/span>
&lt;a href="#%e5%a6%82%e4%bd%95%e5%ae%9e%e7%8e%b0%e5%8a%a8%e6%80%81%e6%9b%b4%e6%96%b0-dns" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>根据实际的域名信息变化，生成对应的 &lt;code>nsupdate&lt;/code> 命令，再执行即可。&lt;/p>
&lt;h1>References&lt;/h1>&lt;ol>
&lt;li>&lt;a href="https://www.cloudflare.com/learning/dns/glossary/dns-zone/" target="_blank" rel="noopener">https://www.cloudflare.com/learning/dns/glossary/dns-zone/&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://www.cloudflare.com/learning/dns/dns-records/" target="_blank" rel="noopener">https://www.cloudflare.com/learning/dns/dns-records/&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://root-servers.org/" target="_blank" rel="noopener">https://root-servers.org/&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://man.openbsd.org/resolv.conf.5" target="_blank" rel="noopener">https://man.openbsd.org/resolv.conf.5&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://www.cloudflare.com/learning/cdn/glossary/anycast-network/" target="_blank" rel="noopener">https://www.cloudflare.com/learning/cdn/glossary/anycast-network/&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://serverfault.com/questions/220775/what-does-the-in-mean-in-a-zone-file" target="_blank" rel="noopener">https://serverfault.com/questions/220775/what-does-the-in-mean-in-a-zone-file&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://en.wikipedia.org/wiki/TSIG" target="_blank" rel="noopener">https://en.wikipedia.org/wiki/TSIG&lt;/a> 更新 dns 需要&lt;/li>
&lt;li>&lt;a href="https://linux.die.net/man/8/ddns-confgen" target="_blank" rel="noopener">https://linux.die.net/man/8/ddns-confgen&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://www.acunetix.com/blog/articles/dns-zone-transfers-axfr/" target="_blank" rel="noopener">https://www.acunetix.com/blog/articles/dns-zone-transfers-axfr/&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://datatracker.ietf.org/doc/html/rfc2136" target="_blank" rel="noopener">https://datatracker.ietf.org/doc/html/rfc2136&lt;/a> Dynamic Updates in the Domain Name System&lt;/li>
&lt;li>&lt;a href="https://www.okta.com/identity-101/hmac/#:~:text=Hash%2Dbased%20message%20authentication%20code,use%20signatures%20and%20asymmetric%20cryptography." target="_blank" rel="noopener">https://www.okta.com/identity-101/hmac/#:~:text=Hash%2Dbased%20message%20authentication%20code,use%20signatures%20and%20asymmetric%20cryptography.&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://bind9.readthedocs.io/en/v9.18.21/chapter1.html#referral" target="_blank" rel="noopener">https://bind9.readthedocs.io/en/v9.18.21/chapter1.html#referral&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://dnns.no/dynamic-dns-with-bind-and-nsupdate.html" target="_blank" rel="noopener">https://dnns.no/dynamic-dns-with-bind-and-nsupdate.html&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://bind9.readthedocs.io/en/v9.18.21/manpages.html#man-dig" target="_blank" rel="noopener">https://bind9.readthedocs.io/en/v9.18.21/manpages.html#man-dig&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://netdns2.com/documentation/request-signing-sig0-and-tsig/" target="_blank" rel="noopener">https://netdns2.com/documentation/request-signing-sig0-and-tsig/&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://bind9.readthedocs.io/en/v9.18.21/reference.html#statements" target="_blank" rel="noopener">https://bind9.readthedocs.io/en/v9.18.21/reference.html#statements&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://www.cloudflare.com/dns/dnssec/how-dnssec-works/" target="_blank" rel="noopener">https://www.cloudflare.com/dns/dnssec/how-dnssec-works/&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://blog.stoplight.io/api-keys-best-practices-to-authenticate-apis" target="_blank" rel="noopener">https://blog.stoplight.io/api-keys-best-practices-to-authenticate-apis&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://bind9.readthedocs.io/en/v9.18.21/chapter7.html#dynamic-update-security" target="_blank" rel="noopener">https://bind9.readthedocs.io/en/v9.18.21/chapter7.html#dynamic-update-security&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://www.rtfm-sarl.ch/articles/using-nsupdate.html" target="_blank" rel="noopener">https://www.rtfm-sarl.ch/articles/using-nsupdate.html&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://dnns.no/dynamic-dns-with-bind-and-nsupdate.html" target="_blank" rel="noopener">https://dnns.no/dynamic-dns-with-bind-and-nsupdate.html&lt;/a> 强烈推荐&lt;/li>
&lt;li>&lt;a href="https://bind9.readthedocs.io/en/v9.18.21/manpages.html#nsupdate-dynamic-dns-update-utility" target="_blank" rel="noopener">https://bind9.readthedocs.io/en/v9.18.21/manpages.html#nsupdate-dynamic-dns-update-utility&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://mp.weixin.qq.com/s/DLKzJ_Paeh52g2SoQkhSVQ" target="_blank" rel="noopener">https://mp.weixin.qq.com/s/DLKzJ_Paeh52g2SoQkhSVQ&lt;/a>&lt;/li>
&lt;li>&lt;a href="http://caunter.ca/nsupdate.txt" target="_blank" rel="noopener">http://caunter.ca/nsupdate.txt&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://datatracker.ietf.org/doc/html/rfc2845" target="_blank" rel="noopener">https://datatracker.ietf.org/doc/html/rfc2845&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://nsrc.org/workshops/2011/pacnog9-dns-ops/raw-attachment/wiki/Agenda/TSIG-17022011.pdf" target="_blank" rel="noopener">https://nsrc.org/workshops/2011/pacnog9-dns-ops/raw-attachment/wiki/Agenda/TSIG-17022011.pdf&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://bind9.readthedocs.io/en/v9.18.21/reference.html#address-match-lists" target="_blank" rel="noopener">https://bind9.readthedocs.io/en/v9.18.21/reference.html#address-match-lists&lt;/a> 非常重要 key 也可以匹配&lt;/li>
&lt;li>&lt;a href="https://serverfault.com/questions/592492/updates-to-a-bind-dynamic-zone-that-is-shared-between-views-delayed" target="_blank" rel="noopener">https://serverfault.com/questions/592492/updates-to-a-bind-dynamic-zone-that-is-shared-between-views-delayed&lt;/a> match-clients 不仅仅是 ip 地址&lt;/li>
&lt;li>&lt;a href="https://datatracker.ietf.org/doc/html/rfc2845" target="_blank" rel="noopener">https://datatracker.ietf.org/doc/html/rfc2845&lt;/a> Secret Key Transaction Authentication for DNS (TSIG)&lt;/li>
&lt;li>&lt;a href="https://hostman.com/tutorials/setting-up-a-bind-dns-server/" target="_blank" rel="noopener">https://hostman.com/tutorials/setting-up-a-bind-dns-server/&lt;/a> 配置bind9&lt;/li>
&lt;li>&lt;a href="https://www.unixmen.com/dns-server-setup-using-bind-9-on-centos-7-linux/" target="_blank" rel="noopener">https://www.unixmen.com/dns-server-setup-using-bind-9-on-centos-7-linux/&lt;/a> 配置&lt;/li>
&lt;li>&lt;a href="https://www.digitalocean.com/community/tutorials/how-to-configure-bind-as-a-private-network-dns-server-on-ubuntu-18-04" target="_blank" rel="noopener">https://www.digitalocean.com/community/tutorials/how-to-configure-bind-as-a-private-network-dns-server-on-ubuntu-18-04&lt;/a>&lt;/li>
&lt;/ol></description></item><item><title>What-happens-type-url-into-browser-and-press-enter</title><link>https://cloudedseal.github.io/blog/what-happens-type-url-into-browser-and-press-enter/</link><pubDate>Sat, 11 Sep 2021 16:21:12 +0800</pubDate><guid>https://cloudedseal.github.io/blog/what-happens-type-url-into-browser-and-press-enter/</guid><description>
&lt;h2>dns query&lt;span class="hx-absolute -hx-mt-20" id="dns-query">&lt;/span>
&lt;a href="#dns-query" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>get the ip of the target domain&lt;/p>
&lt;h3>browser cache&lt;span class="hx-absolute -hx-mt-20" id="browser-cache">&lt;/span>
&lt;a href="#browser-cache" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>firefox(about:networking#dns)
&lt;img src="https://raw.githubusercontent.com/buybyte/pictures/main/img/firefox_dns_cache.png" alt="firefox_dns_cache" loading="lazy" />&lt;/p>
&lt;h3>/etc/hosts&lt;span class="hx-absolute -hx-mt-20" id="etchosts">&lt;/span>
&lt;a href="#etchosts" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;h3>os cache&lt;span class="hx-absolute -hx-mt-20" id="os-cache">&lt;/span>
&lt;a href="#os-cache" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;ol>
&lt;li>macos 查看 dns 请求日志 sudo log stream &amp;ndash;predicate &amp;lsquo;process == &amp;ldquo;mDNSResponder&amp;rdquo;&amp;rsquo; &amp;ndash;info&lt;/li>
&lt;/ol>
&lt;h3>dns resolver&lt;span class="hx-absolute -hx-mt-20" id="dns-resolver">&lt;/span>
&lt;a href="#dns-resolver" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>/etc/resolv.conf&lt;/p>
&lt;ol>
&lt;li>arp -a 查看有没有 dns 服务器的 mac 地址&lt;/li>
&lt;li>ARP request for the nameserver&lt;/li>
&lt;li>send dns query to get the ip of the domain&lt;/li>
&lt;/ol>
&lt;h2>arp 获取 gateway 的 mac 地址&lt;span class="hx-absolute -hx-mt-20" id="arp-获取-gateway-的-mac-地址">&lt;/span>
&lt;a href="#arp-%e8%8e%b7%e5%8f%96-gateway-%e7%9a%84-mac-%e5%9c%b0%e5%9d%80" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;h2>向 gateway 发送 ip packet&lt;span class="hx-absolute -hx-mt-20" id="向-gateway-发送-ip-packet">&lt;/span>
&lt;a href="#%e5%90%91-gateway-%e5%8f%91%e9%80%81-ip-packet" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;h2>References&lt;span class="hx-absolute -hx-mt-20" id="references">&lt;/span>
&lt;a href="#references" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;ol>
&lt;li>&lt;a href="http://www.science.smith.edu/~nhowe/262/oldlabs/keyboard.html" target="_blank" rel="noopener">keyborad-interrput&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://www.zhihu.com/question/560616439/answer/2722866208" target="_blank" rel="noopener">Chrome 是怎么判断地址栏输入的东西是不是网址? 这就是第一步😂-omnibox&lt;/a>&lt;/li>
&lt;li>&lt;a href="about:networking#dns" >firefox dns&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://www.fortinet.com/resources/cyberglossary/what-is-arp" target="_blank" rel="noopener">ARP&lt;/a>&lt;/li>
&lt;/ol></description></item><item><title>network-dns</title><link>https://cloudedseal.github.io/blog/network-dns/</link><pubDate>Thu, 23 Apr 2020 10:27:04 +0800</pubDate><guid>https://cloudedseal.github.io/blog/network-dns/</guid><description>
&lt;blockquote>
&lt;p>怎样学习一个新的东西，也可以按照一定的套路的。这个东西解决什么问题？这个东西怎样解决问题？
还有没有其他方法？&lt;/p>
&lt;/blockquote>
&lt;h2>三步走分析一下 DNS&lt;span class="hx-absolute -hx-mt-20" id="三步走分析一下-dns">&lt;/span>
&lt;a href="#%e4%b8%89%e6%ad%a5%e8%b5%b0%e5%88%86%e6%9e%90%e4%b8%80%e4%b8%8b-dns" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;h3>解决什么问题&lt;span class="hx-absolute -hx-mt-20" id="解决什么问题">&lt;/span>
&lt;a href="#%e8%a7%a3%e5%86%b3%e4%bb%80%e4%b9%88%e9%97%ae%e9%a2%98" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>根据域名找到 IP。为啥要找到域名对应的 IP 呢？答案很简单，因为 &lt;code>TCP/IP&lt;/code> 协议栈需要。
很常见的一个问题就是浏览器得到一个 web page 的流程是啥样的。&lt;/p>
&lt;h3>什么方式解决问题&lt;span class="hx-absolute -hx-mt-20" id="什么方式解决问题">&lt;/span>
&lt;a href="#%e4%bb%80%e4%b9%88%e6%96%b9%e5%bc%8f%e8%a7%a3%e5%86%b3%e9%97%ae%e9%a2%98" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>怎样组织&lt;code>域名(domain name)&lt;/code>？这是域名系统的首要问题。底层的组织架构，决定了域名解析的流程。有点经济基础决定上层建筑的意思。域名少的时候可以直接放在一个文件里。对，这个文件在类 unix 系统里就是 &lt;code>/etc/hosts&lt;/code> 的文件。但是域名超级多怎么办？分类、组成层次结构。就像 Linux 的文件系统的组织方式一样。组织成一个树状结构。DNS 的查询问题，那就可以视为树的遍历问题。&lt;/p>
&lt;h4>top level domain&lt;span class="hx-absolute -hx-mt-20" id="top-level-domain">&lt;/span>
&lt;a href="#top-level-domain" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h4>&lt;p>&lt;code>com&lt;/code>、&lt;code>org&lt;/code>、 &lt;code>cn&lt;/code> 等等就是所谓的&lt;a href="http://data.iana.org/TLD/tlds-alpha-by-domain.txt" target="_blank" rel="noopener">顶级域名&lt;/a>。也就是一级域名。那么问题就来了，这些顶级域名存放在哪呢？存放到 &lt;a href="https://www.cloudflare.com/learning/dns/glossary/dns-root-server/" target="_blank" rel="noopener">root server&lt;/a>。换一种理解方法就是，这些 root server 就是顶级域名的 metadata。这些 &lt;a href="https://www.iana.org/domains/root/servers" target="_blank" rel="noopener">root server IP&lt;/a> 是固定的。实现 DNS 这个功能的软件内置这些 root server 的 ip。这一点很重要。&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">rpm -ql &lt;span class="nb">bind&lt;/span> &lt;span class="p">|&lt;/span> grep named.ca
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/usr/share/doc/bind-9.11.4/sample/var/named/named.ca
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/var/named/named.ca&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;blockquote>
&lt;p>centos 上安装 &lt;code>bind9&lt;/code> 这个文件包含所有的 root servers 的 ip&lt;/p>
&lt;/blockquote>
&lt;h4>second level domain&lt;span class="hx-absolute -hx-mt-20" id="second-level-domain">&lt;/span>
&lt;a href="#second-level-domain" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h4>&lt;p>以 &lt;code>www.google.com.&lt;/code> 为例 &lt;code>google&lt;/code> 就是二级域名。其他的依此类推。&lt;/p>
&lt;h4>DNS 层级树&lt;span class="hx-absolute -hx-mt-20" id="dns-层级树">&lt;/span>
&lt;a href="#dns-%e5%b1%82%e7%ba%a7%e6%a0%91" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h4>&lt;p>&lt;img src="https://github.com/stardustman/pictures/raw/main/img/dns-hierarchy.svg" alt="DNS 层级树" loading="lazy" />&lt;/p>
&lt;blockquote>
&lt;p>可以看到整个 DNS 的入口就是 root。也就是记录顶级域名在哪些服务器上的信息。这是 &lt;code>root&lt;/code> 也就是不需要解析这些记录顶级域名的服务器。直接固定了这些 &lt;a href="https://www.iana.org/domains/root/servers" target="_blank" rel="noopener">root server 的 IP&lt;/a> 地址。实现 DNS 功能的软件，直接内置这些固定的 IP。DNS 查询第一步就是向这些 root server 查询顶级域名对应哪些 nameserver，也就是顶级域名对应的 IP。其实 DNS也就是个分布式层级数据库。注册域名也就是向数据库添加一条记录。但是不是免费注册的。&lt;/p>
&lt;/blockquote>
&lt;h4>DNS Zone&lt;span class="hx-absolute -hx-mt-20" id="dns-zone">&lt;/span>
&lt;a href="#dns-zone" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h4>&lt;p>&lt;img src="https://github.com/stardustman/pictures/raw/main/img/dns-zone.svg" alt="DNS Zone" loading="lazy" />&lt;/p>
&lt;blockquote>
&lt;p>可以看到整个 DNS 层级树，每一个节点对应一个 Zone。&lt;/p>
&lt;/blockquote>
&lt;h4>uncached DNS lookup&lt;span class="hx-absolute -hx-mt-20" id="uncached-dns-lookup">&lt;/span>
&lt;a href="#uncached-dns-lookup" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h4>&lt;p>&lt;img src="https://github.com/stardustman/pictures/raw/main/img/network-dns.svg" alt="dns-look-up" loading="lazy" />&lt;/p>
&lt;blockquote>
&lt;p>图中 &lt;code>OS stub resovler&lt;/code> 就是负责 DNS 解析的进程，发起 DNS 递归查询请求。
&lt;code>local dns server&lt;/code> 发起迭代查询，查询域名对应的 IP。之后返给 &lt;code>OS stub resovler&lt;/code>(name servers that provide the complete answers to user queries)。&lt;/p>
&lt;/blockquote>
&lt;ol>
&lt;li>这个进程向 &lt;code>local dns server&lt;/code> 发起递归查询。也就是只需要等 &lt;code>local dns server&lt;/code> 查询结果就行。&lt;/li>
&lt;li>&lt;code>local dns server&lt;/code> 发起迭代查询。因为 &lt;code>local dns server&lt;/code> 有所有 root server 的 IP，选择一个 IP，根据顶级域名属于哪一个 &lt;code>TLD Zone&lt;/code>， 发起迭代查询。&lt;/li>
&lt;li>可以查询得到记录这个顶级域名的 TLD server 有哪些，以及这些服务器的 IP。&lt;/li>
&lt;li>&lt;code>local dns server&lt;/code> 选择一个 TLD server，发起迭代查询。&lt;/li>
&lt;li>得到这个域名的权威服务器。&lt;/li>
&lt;li>选择一个权威服务器，发起迭代查询，查询域名对应的 IP。&lt;/li>
&lt;li>&lt;code>local dns server&lt;/code> 从权威服务器得到域名对应的 IP。&lt;/li>
&lt;li>返还给 &lt;code>OS stub resovler&lt;/code>。递归查询结束。&lt;/li>
&lt;/ol>
&lt;blockquote>
&lt;p>Systems normally lookup any name (including domain names) using the hosts file first (if present), followed by DNS.
However, the nsswitch.conf file (typically in /etc) controls this order (normally hosts: file dns), allowing the order to be changed or the file value to be deleted entirely depending on local needs.&lt;/p>
&lt;/blockquote>
&lt;h3>有没有其他解决方案&lt;span class="hx-absolute -hx-mt-20" id="有没有其他解决方案">&lt;/span>
&lt;a href="#%e6%9c%89%e6%b2%a1%e6%9c%89%e5%85%b6%e4%bb%96%e8%a7%a3%e5%86%b3%e6%96%b9%e6%a1%88" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;h2>dig 命令&lt;span class="hx-absolute -hx-mt-20" id="dig-命令">&lt;/span>
&lt;a href="#dig-%e5%91%bd%e4%bb%a4" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;h3>dig domainname&lt;span class="hx-absolute -hx-mt-20" id="dig-domainname">&lt;/span>
&lt;a href="#dig-domainname" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;pre>&lt;code> ~ dig github.com
; &amp;lt;&amp;lt;&amp;gt;&amp;gt; DiG 9.10.6 &amp;lt;&amp;lt;&amp;gt;&amp;gt; github.com
;; global options: &amp;#43;cmd
;; Got answer:
;; -&amp;gt;&amp;gt;HEADER&amp;lt;&amp;lt;- opcode: QUERY, status: NOERROR, id: 23033
;; flags: qr rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 0, ADDITIONAL: 0
;; QUESTION SECTION:
;github.com. IN A
;; ANSWER SECTION:
github.com. 17 IN A 52.74.223.119 # github.com. 这个域名对应的一个 ip
;; Query time: 14 msec
;; SERVER: 61.139.2.69#53(61.139.2.69)
;; WHEN: Thu Apr 23 19:53:17 CST 2020
;; MSG SIZE rcvd: 44&lt;/code>&lt;/pre>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;h3>wireshark 抓包验证实际的网络架构&lt;span class="hx-absolute -hx-mt-20" id="wireshark-抓包验证实际的网络架构">&lt;/span>
&lt;a href="#wireshark-%e6%8a%93%e5%8c%85%e9%aa%8c%e8%af%81%e5%ae%9e%e9%99%85%e7%9a%84%e7%bd%91%e7%bb%9c%e6%9e%b6%e6%9e%84" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;h4>TCP/IP stack&lt;span class="hx-absolute -hx-mt-20" id="tcpip-stack">&lt;/span>
&lt;a href="#tcpip-stack" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h4>&lt;p>&lt;img src="https://github.com/stardustman/pictures/raw/main/img/tcp-ip-stack-dns.png" alt="tcp-ip-stack" loading="lazy" />&lt;/p>
&lt;h3>dig +trace domainname&lt;span class="hx-absolute -hx-mt-20" id="dig-trace-domainname">&lt;/span>
&lt;a href="#dig-trace-domainname" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">~ dig +trace github.com
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">;&lt;/span> &amp;lt;&amp;lt;&amp;gt;&amp;gt; DiG 9.10.6 &amp;lt;&amp;lt;&amp;gt;&amp;gt; +trace github.com
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">;;&lt;/span> global options: +cmd
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">. &lt;span class="m">81219&lt;/span> IN NS k.root-servers.net.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">. &lt;span class="m">81219&lt;/span> IN NS e.root-servers.net.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">. &lt;span class="m">81219&lt;/span> IN NS b.root-servers.net.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">. &lt;span class="m">81219&lt;/span> IN NS a.root-servers.net.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">. &lt;span class="m">81219&lt;/span> IN NS m.root-servers.net.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">. &lt;span class="m">81219&lt;/span> IN NS l.root-servers.net.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">. &lt;span class="m">81219&lt;/span> IN NS d.root-servers.net.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">. &lt;span class="m">81219&lt;/span> IN NS f.root-servers.net.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">. &lt;span class="m">81219&lt;/span> IN NS g.root-servers.net.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">. &lt;span class="m">81219&lt;/span> IN NS h.root-servers.net.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">. &lt;span class="m">81219&lt;/span> IN NS j.root-servers.net.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">. &lt;span class="m">81219&lt;/span> IN NS c.root-servers.net.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">. &lt;span class="m">81219&lt;/span> IN NS i.root-servers.net.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">;;&lt;/span> Received &lt;span class="m">228&lt;/span> bytes from 61.139.2.69#53&lt;span class="o">(&lt;/span>61.139.2.69&lt;span class="o">)&lt;/span> in &lt;span class="m">15&lt;/span> ms &lt;span class="c1">#local dns server，本地 DNS 拥有完整的 root server ip 列表。内置到本地 DNS 服务器。&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">com. &lt;span class="m">172800&lt;/span> IN NS l.gtld-servers.net. &lt;span class="c1"># 记录 com. 这个顶级域名的服务器，generic top level domain server&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">com. &lt;span class="m">172800&lt;/span> IN NS b.gtld-servers.net.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">com. &lt;span class="m">172800&lt;/span> IN NS c.gtld-servers.net.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">com. &lt;span class="m">172800&lt;/span> IN NS d.gtld-servers.net.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">com. &lt;span class="m">172800&lt;/span> IN NS e.gtld-servers.net.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">com. &lt;span class="m">172800&lt;/span> IN NS f.gtld-servers.net.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">com. &lt;span class="m">172800&lt;/span> IN NS g.gtld-servers.net.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">com. &lt;span class="m">172800&lt;/span> IN NS a.gtld-servers.net.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">com. &lt;span class="m">172800&lt;/span> IN NS h.gtld-servers.net.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">com. &lt;span class="m">172800&lt;/span> IN NS i.gtld-servers.net.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">com. &lt;span class="m">172800&lt;/span> IN NS j.gtld-servers.net.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">com. &lt;span class="m">172800&lt;/span> IN NS k.gtld-servers.net.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">com. &lt;span class="m">172800&lt;/span> IN NS m.gtld-servers.net.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">com. &lt;span class="m">86400&lt;/span> IN DS &lt;span class="m">30909&lt;/span> &lt;span class="m">8&lt;/span> &lt;span class="m">2&lt;/span> E2D3C916F6DEEAC73294E8268FB5885044A833FC5459588F4A9184CF C41A5766
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">com. &lt;span class="m">86400&lt;/span> IN RRSIG DS &lt;span class="m">8&lt;/span> &lt;span class="m">1&lt;/span> &lt;span class="m">86400&lt;/span> &lt;span class="m">20200506050000&lt;/span> &lt;span class="m">20200423040000&lt;/span> &lt;span class="m">48903&lt;/span> . Enqd4bffSJHlv8mqHcAptS9+fHo3cg6vCIQgrOZ3aBfx2nG4CjS27iEG 6u6NsPfcKVrz7RoU2xDtDMNJOcMBJdJe/lGNeo14N69SM0/MV2Z8wZBD HRPd2Y8Z1nyc7EnDbkFzuWV5G6vafaQa4KTQpG6jGOPIQpYESNiinxfy 0QQWUJELvjSOideCPqQcug2P2Pln7BzWiqFSg6I8d1h44349LsXcbr5W zJwZQJKLoDd0ysyGl5Bq3UZgfWYvTJFmmZ/OwKYT4QQ4BE0MtbVwae8X 9yI6d9jENsz+eebEEtxLt6o/LNQb3PdNhUH1PC1pxfHiEiNyYUcvbJdf &lt;span class="nv">Flgntg&lt;/span>&lt;span class="o">==&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">;;&lt;/span> Received &lt;span class="m">1170&lt;/span> bytes from 192.203.230.10#53&lt;span class="o">(&lt;/span>e.root-servers.net&lt;span class="o">)&lt;/span> in &lt;span class="m">211&lt;/span> ms &lt;span class="c1"># 从 e.root-servers.net 这个 root server 查询到的 TLD namesever，也就是存储 com. 这个顶级域名的服务器。&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">github.com. &lt;span class="m">172800&lt;/span> IN NS ns1.p16.dynect.net. &lt;span class="c1"># 记录 github.com. 这个域名的权威服务器&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">github.com. &lt;span class="m">172800&lt;/span> IN NS ns3.p16.dynect.net.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">github.com. &lt;span class="m">172800&lt;/span> IN NS ns2.p16.dynect.net.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">github.com. &lt;span class="m">172800&lt;/span> IN NS ns4.p16.dynect.net.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">github.com. &lt;span class="m">172800&lt;/span> IN NS ns-520.awsdns-01.net.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">github.com. &lt;span class="m">172800&lt;/span> IN NS ns-421.awsdns-52.com.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">github.com. &lt;span class="m">172800&lt;/span> IN NS ns-1707.awsdns-21.co.uk.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">github.com. &lt;span class="m">172800&lt;/span> IN NS ns-1283.awsdns-32.org.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">CK0POJMG874LJREF7EFN8430QVIT8BSM.com. &lt;span class="m">86400&lt;/span> IN NSEC3 &lt;span class="m">1&lt;/span> &lt;span class="m">1&lt;/span> &lt;span class="m">0&lt;/span> - CK0Q1GIN43N1ARRC9OSM6QPQR81H5M9A NS SOA RRSIG DNSKEY NSEC3PARAM
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">CK0POJMG874LJREF7EFN8430QVIT8BSM.com. &lt;span class="m">86400&lt;/span> IN RRSIG NSEC3 &lt;span class="m">8&lt;/span> &lt;span class="m">2&lt;/span> &lt;span class="m">86400&lt;/span> &lt;span class="m">20200427045033&lt;/span> &lt;span class="m">20200420034033&lt;/span> &lt;span class="m">39844&lt;/span> com. BDAWMm4AsSRfrBwOXhNN8ihw++J2UkhEk8A6LeSIz1llDs5kt0CcOqTM OK1txlQNr3N0k1RTBW/hkEZ1mxjIHF2GARt/hpO43ILPBVs/vhKAKCKh A96XJG+NzN0t/heB6mFNASKAcmVdfT5a0tVkmmzhGktDp5ECdZAIFRhZ &lt;span class="nv">8y6jxsUhGP7ZiN1AfFBi1cWeSth5FW4Btpy9RffVKg5lIA&lt;/span>&lt;span class="o">==&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">4KB4DFS71LEP8G8P8VT4CCUSQNL4CNCS.com. &lt;span class="m">86400&lt;/span> IN NSEC3 &lt;span class="m">1&lt;/span> &lt;span class="m">1&lt;/span> &lt;span class="m">0&lt;/span> - 4KB4PTQQ5CTA7POCTGM7RUFC8B1RKTEU NS DS RRSIG
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">4KB4DFS71LEP8G8P8VT4CCUSQNL4CNCS.com. &lt;span class="m">86400&lt;/span> IN RRSIG NSEC3 &lt;span class="m">8&lt;/span> &lt;span class="m">2&lt;/span> &lt;span class="m">86400&lt;/span> &lt;span class="m">20200428061912&lt;/span> &lt;span class="m">20200421050912&lt;/span> &lt;span class="m">39844&lt;/span> com. PFN1p6XvR4SmD4ucRULmtYIMQkFf/ZrdEWz6bRVtcepYF6QwTC/VOVYM 7PV0tuTTdr1LqkUwQJ7mv23vtKnjFba2Cf7pBOTz9JuCHUC0Qml9cOc6 Cwjhx7haj6h0VEzS+oIY7l2p/af/B36iQCXASVN3Y6s/i+66iXIg905z GqFnAKOgR0R4KJx5KwHIzBkgxr/I/SyCd+HNw+2fr15X0w&lt;span class="o">==&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">;;&lt;/span> Received &lt;span class="m">824&lt;/span> bytes from 192.26.92.30#53&lt;span class="o">(&lt;/span>c.gtld-servers.net&lt;span class="o">)&lt;/span> in &lt;span class="m">173&lt;/span> ms &lt;span class="c1"># 从 c.gtld-servers.net 这个 TLD nameserver 查询到存储 github.com. 这个域名的权威服务器。&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">github.com. &lt;span class="m">60&lt;/span> IN A 13.250.177.223 &lt;span class="c1"># 得到了 github.com. 这个域名的一个 ip&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">github.com. &lt;span class="m">900&lt;/span> IN NS ns-1707.awsdns-21.co.uk.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">github.com. &lt;span class="m">900&lt;/span> IN NS ns3.p16.dynect.net.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">github.com. &lt;span class="m">900&lt;/span> IN NS ns2.p16.dynect.net.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">github.com. &lt;span class="m">900&lt;/span> IN NS ns-1283.awsdns-32.org.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">github.com. &lt;span class="m">900&lt;/span> IN NS ns-421.awsdns-52.com.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">github.com. &lt;span class="m">900&lt;/span> IN NS ns-520.awsdns-01.net.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">github.com. &lt;span class="m">900&lt;/span> IN NS ns4.p16.dynect.net.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">github.com. &lt;span class="m">900&lt;/span> IN NS ns1.p16.dynect.net.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">;;&lt;/span> Received &lt;span class="m">275&lt;/span> bytes from 204.13.250.16#53&lt;span class="o">(&lt;/span>ns2.p16.dynect.net&lt;span class="o">)&lt;/span> in &lt;span class="m">198&lt;/span> ms 从 ns2.p16.dynect.net 这个权威服务器查询到的 github.com. 的 ip 是 13.250.177.223。至此，得到域名对应的 ip。&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;h2>DNS 记录类型&lt;span class="hx-absolute -hx-mt-20" id="dns-记录类型">&lt;/span>
&lt;a href="#dns-%e8%ae%b0%e5%bd%95%e7%b1%bb%e5%9e%8b" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;h3>CNAME&lt;span class="hx-absolute -hx-mt-20" id="cname">&lt;/span>
&lt;a href="#cname" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>&lt;code>Canonical Name&lt;/code> 域名指向另一个域名。见下图：&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl"> dig -t cname music.163.com
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">;&lt;/span> &amp;lt;&amp;lt;&amp;gt;&amp;gt; DiG 9.10.6 &amp;lt;&amp;lt;&amp;gt;&amp;gt; -t cname music.163.com
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">;;&lt;/span> global options: +cmd
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">;;&lt;/span> Got answer:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">;;&lt;/span> -&amp;gt;&amp;gt;HEADER&lt;span class="s">&amp;lt;&amp;lt;- opco&lt;/span>de: QUERY, status: NOERROR, id: &lt;span class="m">12400&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">;;&lt;/span> flags: qr aa rd ra&lt;span class="p">;&lt;/span> QUERY: 1, ANSWER: 1, AUTHORITY: 0, ADDITIONAL: &lt;span class="m">0&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">;;&lt;/span> QUESTION SECTION:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">;&lt;/span>music.163.com. IN CNAME
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">;;&lt;/span> ANSWER SECTION:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">music.163.com. 1 IN CNAME music.ntes53.netease.com.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">;;&lt;/span> Query time: &lt;span class="m">0&lt;/span> msec
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">;;&lt;/span> SERVER: 198.18.0.2#53&lt;span class="o">(&lt;/span>198.18.0.2&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">;;&lt;/span> WHEN: Fri Oct &lt;span class="m">06&lt;/span> 11:41:17 CST &lt;span class="m">2023&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">;;&lt;/span> MSG SIZE rcvd: &lt;span class="m">82&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;h3>A&lt;span class="hx-absolute -hx-mt-20" id="a">&lt;/span>
&lt;a href="#a" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>&lt;code>address&lt;/code> ip address&lt;/p>
&lt;h3>NS&lt;span class="hx-absolute -hx-mt-20" id="ns">&lt;/span>
&lt;a href="#ns" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>&lt;code>name server&lt;/code> 保存下一级域名的服务器，只设置成域名。&lt;/p>
&lt;h3>PTR&lt;span class="hx-absolute -hx-mt-20" id="ptr">&lt;/span>
&lt;a href="#ptr" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>&lt;code>pointer record&lt;/code>，根据 ip 查询域名。类似 ARP，用 ip 找 MAC 地址。&lt;/p>
&lt;h3>MX&lt;span class="hx-absolute -hx-mt-20" id="mx">&lt;/span>
&lt;a href="#mx" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>mail exchange 电子邮件服务器&lt;/p>
&lt;h3>TXT&lt;span class="hx-absolute -hx-mt-20" id="txt">&lt;/span>
&lt;a href="#txt" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>&lt;a href="https://allagora.wordpress.com/2022/03/22/use-dns-txt-lookup-to-gain-quick-insights-which-services-companies-are-using/" target="_blank" rel="noopener">可以获取这个网站在使用那些第三方服务&lt;/a>&lt;/p>
&lt;h2>Reference&lt;span class="hx-absolute -hx-mt-20" id="reference">&lt;/span>
&lt;a href="#reference" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;ol>
&lt;li>&lt;a href="https://www.ruanyifeng.com/blog/2016/06/dns.html" target="_blank" rel="noopener">DNS 入门&lt;/a>&lt;/li>
&lt;li>&lt;a href="http://kilyos.ee.bilkent.edu.tr/~ee538/lecture1.pdf" target="_blank" rel="noopener">Introduction and Layered Network Architecture&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://www.iana.org/domains/root/servers" target="_blank" rel="noopener">root servers ips&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://root-servers.org/" target="_blank" rel="noopener">all-root-servers&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://tools.ietf.org/html/rfc2929" target="_blank" rel="noopener">rfc-dns&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://www.cloudflare.com/learning/dns/dns-server-types/" target="_blank" rel="noopener">dns-server-types&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://www.cloudflare.com/learning/dns/what-is-dns/" target="_blank" rel="noopener">what is dns&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://www.cloudflare.com/learning/dns/what-is-recursive-dns/" target="_blank" rel="noopener">what is recursive dns&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://simpledns.plus/help/dns-record-types" target="_blank" rel="noopener">dns record types&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://www.cs.cmu.edu/~pattis/15-1XX/common/handouts/ascii.html" target="_blank" rel="noopener">ascii&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://www.cloudflare.com/learning/dns/glossary/dns-zone/" target="_blank" rel="noopener">dns-zone&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://bind9.readthedocs.io/en/v9.18.21/chapter3.html#localhost-zone-file" target="_blank" rel="noopener">zone-file&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://viewdns.info/" target="_blank" rel="noopener">viewdns&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://allagora.wordpress.com/2022/03/22/use-dns-txt-lookup-to-gain-quick-insights-which-services-companies-are-using/" target="_blank" rel="noopener">dns record txt&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://www.nslookup.io/" target="_blank" rel="noopener">https://www.nslookup.io/&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://whois.gandi.net/zh-hans" target="_blank" rel="noopener">域名信息查询&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://www.dnsperf.com/" target="_blank" rel="noopener">dns延迟测试&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://messwithdns.net/" target="_blank" rel="noopener">dns实践&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://github.com/ogham/dog" target="_blank" rel="noopener">dns-client-dog&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://github.com/mr-karan/doggo" target="_blank" rel="noopener">dns-client-doggo&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://dnsspeedtest.online/" target="_blank" rel="noopener">dns速度测试&lt;/a>&lt;/li>
&lt;/ol></description></item></channel></rss>